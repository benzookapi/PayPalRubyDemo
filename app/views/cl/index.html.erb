<h4>Choose Endpoint (<%= PpClassic::IS_PROD ? "Production" : "Sandbox" %>) <a href="https://developer.paypal.com/docs/classic/api/" target="_blank">details</a>
</h4>
<%= raw show_endpoint(session[:endpoint]) %>
<br/>

<%= raw show_ua(session[:ua], request.user_agent) %>
<p>navigator.userAgent (JS): <span id="js_ua"></span></p>

<h4>Express Checkout API</h4>
<table class="table table-striped">
        <tbody>
          <tr>
            <td style="width:20%;">
              SetExpressCheckout
            </td>
            <td>
              <%= form_tag("/cl/setec", method: "post") do %>
                <p>
                <%= label_tag(nil, "Parameters") %>
                <%= link_to("details", 'https://developer.paypal.com/docs/classic/api/merchant/SetExpressCheckout_API_Operation_NVP/', :target => '_blank') %>
                <%= text_area_tag('q_setec', session[:q_setec], {:rows=>'3', :class=>'form-control'}) %>
                <%= hidden_field_tag('endpoint','', :id=>'e_setec') %>
                </p>
               <%= button_tag("1.Begin the payment!", :class =>'btn btn-default') %>
              <% end %>
              <%= raw show_res('SetExpressCheckout', @res) if request.path_info == '/cl/setec' || request.fullpath.include?('st=') %>
            </td>
          </tr>

          <tr>
            <td>
              GetExpressCheckoutDetails
            </td>
            <td>
              <%= form_tag("/cl/getec", method: "post") do %>
                <p>
                <%= label_tag(nil, "TOKEN") %>
                <%= text_field_tag('t_getec', @t_getec, :class=>'form-control') %>
                <%= hidden_field_tag('t_doec', @t_doec) %>
                <%= hidden_field_tag('t_crrp', @t_crrp) %>
                <%= hidden_field_tag('p_doec', @p_doec) %>
                <%= hidden_field_tag('q_doec', @q_doec) %>
                </p>
               <%= button_tag("2.Check the paymant!", :class =>'btn btn-default') %>
              <% end %>
              <%= raw show_res('GetExpressCheckoutDetails', @res) if request.path_info == '/cl/getec' %>
            </td>
          </tr>

          <tr>
            <td>
              DoExpressCheckoutPayment
            </td>
            <td>
              <%= form_tag("/cl/doec", method: "post") do %>
                <p>
                <%= label_tag(nil, "TOKEN") %>
                <%= text_field_tag('t_doec', @t_doec, :class=>'form-control') %>
                <%= label_tag(nil, "PAYERID") %>
                <%= text_field_tag('p_doec', @p_doec, :class=>'form-control') %>
                <%= label_tag(nil, "Parameters") %>
                <%= link_to("details", 'https://developer.paypal.com/docs/classic/api/merchant/DoExpressCheckoutPayment_API_Operation_NVP/', :target => '_blank') %>
                <%= text_area_tag('q_doec', @q_doec, {:rows=>'3', :class=>'form-control'}) %>
                <%= hidden_field_tag('t_getec', @t_getec) %>
                <%= hidden_field_tag('t_crrp', @t_crrp) %>
                </p>
               <%= button_tag("3.Finish the payment!", :class =>'btn btn-default') %>
              <% end %>
              <%= raw show_res('DoExpressCheckoutPayment', @res) if request.path_info == '/cl/doec' %>
            </td>
          </tr>

          <tr>
            <td style="width:20%;">
              CreateRecurringPaymentsProfile<br/>(For RP)
            </td>
            <td>
              <%= form_tag("/cl/crrp", method: "post") do %>
                <p>
                <%= label_tag(nil, "TOKEN") %>
                <%= text_field_tag('t_crrp', @t_crrp, :class=>'form-control') %>
                <%= label_tag(nil, "PROFILESTARTDATE") %>
                <%= text_field_tag('sd_crrp', @sd_crrp, :class=>'form-control') %>
                <%= label_tag(nil, "Parameters") %>
                <%= link_to("details", 'https://developer.paypal.com/docs/classic/api/merchant/CreateRecurringPaymentsProfile_API_Operation_NVP/', :target => '_blank') %>
                <%= text_area_tag('q_crrp', session[:q_crrp], {:rows=>'3', :class=>'form-control'}) %>
                <%= hidden_field_tag('t_getec', @t_getec) %>
                <%= hidden_field_tag('t_doec', @t_doec) %>
                <%= hidden_field_tag('p_doec', @p_doec) %>
                <%= hidden_field_tag('q_doec', @q_doec) %>
                </p>
               <%= button_tag("Create Recurring Payment", :class =>'btn btn-default') %>
              <% end %>
              <%= raw show_res('CreateRecurringPaymentsProfile', @res) if request.path_info == '/cl/crrp' %>
            </td>
          </tr>

    </tbody>
</table>

<h4>Transaction API</h4>
<table class="table table-striped">
    <tbody>
          <tr>
            <td style="width:20%;">
              TransactionSearch
            </td>
            <td>
              <%= form_tag("/cl/trsr", method: "post") do %>
                <p>
                <%= label_tag(nil, "STARTDATE") %>
                <%= text_field_tag('sd_trsr', @sd_trsr, :class=>'form-control') %>
                <%= label_tag(nil, "Parameters") %>
                <%= link_to("details", 'https://developer.paypal.com/docs/classic/api/merchant/TransactionSearch_API_Operation_NVP/', :target => '_blank') %>
                <%= text_area_tag('q_trsr', @q_trsr, {:rows=>'3', :class=>'form-control'}) %>
                </p>
               <%= button_tag("Search Transactions", :class =>'btn btn-default') %>
              <% end %>
              <%= raw show_res('TransactionSearch', @res) if request.path_info == '/cl/trsr' %>
            </td>
          </tr>
    </tbody>
</table>




<script>
var setEp = function () {
  $("#e_setec").val($('#e_p').val());
};

$('#e_p').change(setEp);

setEp();

$("#js_ua").text(navigator.userAgent);

</script>
